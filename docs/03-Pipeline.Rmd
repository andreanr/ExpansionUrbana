---
output:
  pdf_document: default
---
# Pipeline

Todo lo anterior se puede plantear de una manera específica. 
Utilizando métodos ...

## Construcción de Base de Datos
El presente estudio busca aplicar herramientas de aprendizaje estadístico para predecir la expansión urbana de la Zona Metropolitana de Chihuahua a través de características geográficas y demográficas y económicas descritas a continuación.

Debido a la naturaleza de la información de las variables se decidió utilizar una cuadrícula o malla para representar la información. 

Se propone crear una malla cuadriculada de polígonos que cubran toda el área de influencia del modelo, en este caso la zona metropolitana de Chihuahua. De esta forma se organiza la información relevante obtenida a través de distintas fuentes dentro de la malla de tal manera que cada cuadrícula posee la información asociada a cada área. Además  a cada cuadrícula se le asigna una variable que indica si pertenece o no a la mancha urbana representada por los ageb.

Construcción de la Malla:
- Malla: malla cuadriculada de polígonos que cubran toda el área de influencia del modelo de 250 metros x 250 metros.
- Área de influencia: Será sobre la cual se realiza la modelación y se asume que el crecimiento no superará esta área de influencia. Para Chihuahua, se consideró un radio de 7,000 metros.

### Datos demográficos
Se utilizó la información de los censos 2000 y 2010, junto con la del conteo del 2005 \cite{inegi} a nivel AGEB (explicar qué es ageb como i) 
se realizó el siguiente procedimiento:

a. Se realizó una transformación de coordenadas correspondientes para tener tanto el shapefile de los AGEB como la malla dentro de las mismas unidades, en este caso UTM zona 13 Norte.  

b. Se calculó el área de cada AGEB en metros.  

c. Se intersectó el shapefile de AGEBs con la malla cuadriculada como se muestra en la siguiente figura. Utilizando esta intersección, se le agregó a la malla las variables elegidas del censo de población y vivienda (o conteo para 2005) de acuerdo a la proporción de área del AGEB que intersecta a cada cuadrícula.   

d. Para realizarlo, primero se calculó el área de cada polígono de la intersección y se obtuvo la proporción de área que le corresponde a cada polígono de la intersección con respecto al área total del AGEB al que corresponde.   

e. A partir de las proporciones de área de cada polígono con respecto al área total de AGEB que le corresponde, se calculó la proporción correspondiente para cada variable. Si la variable correspondía a una cantidad total dentro del AGEB, entonces esta variable se multiplicó por la proporción de área obtenida en el inciso (f), mientras que en el caso en el que la variable correspondiera a un promedio entonces se le asoció al polígono el dato del AGEB correspondiente.   

f. A la tabla de atributos de la malla se le agregaron las variables de interés de SCINCE. Para realizar esto, se sumó o promedió, de acuerdo al tipo de variable, la información de los polígonos de la intersección que caían dentro de una misma cuadrícula del grid.   

g. Además, se agregaron las variables ZU_25, ZU_30, ZU_50, ZU_75 a la malla. Estas variables indican si el i% con i={25, 30, 50, 75} de la cuadrícula del grid pertenece o no a la mancha urbana de los AGEB.   

Después de haber incluido las variables de las AGEB urbanas dentro de la malla, se agregó la misma información las localidades rurales que caen dentro del área de influencia (la malla). Para esto, se utilizó la información proveniente de los principales resultados por localidad (ITER) de 2000, 2005 y 2010 (INEGI) y agregaron dentro de la malla de la siguiente manera:


i) Primero se corrigieron y homologaron las coordenadas que vienen reportadas en el ITER, debido a que estas coordenadas vienen reportadas en grados, minutos y segundos, además se corrigió el signo de la latitud. De esta manera se pudo obtener el sistema de coordenadas geográficas de las localidades [en CRS(“+proj=longlat +datum=WGS84”)]para generar un shapefile. Después de ser proyectado, se transformaron las coordenadas en UTM zona 13 para hacerlo coincidir con la malla.

ii) Debido a que existían diferencias en la ubicación de una misma localidad para los distintos años, esto a causa principalmente de los cambios en la precisión de los GPS, se siguen los siguientes pasos para corregir la información:  

a) A las localidades rurales de 2000 y 2005 que se ubicaran en coordenadas distintas a las de 2010, se reubicaron de acuerdo a las coordenadas de 2010. De esta forma una misma localidad coincidirá en coordenadas para los tres años. El motivo de reasignarlo a las coordenadas de 2010 se debe a que la precisión de los GPS’s ha aumentado; por lo que las coordenadas de 2010 tendrán una precisión mayor.   

b) Siguiendo la misma lógica para las localidades rurales que en el año 2000 se encontraran en distintas coordenadas que en 2005 y además que no se encontraran en 2010, ya sea porque se unieron a una localidad urbana o simplemente desparecieron,  entonces a esas las localidades de 2000 se les reasignaron sus coordenadas a las de 2005.   

c)  Por último, si una localidad rural se encontraba en 2000 y en 2010 pero no en 2005, entonces se generó la información de esa localidad para 2005 tomando los valores promedio de 2000 y 2010. 

iii) Una vez homogeneizando las coordenadas, se incluyó la información del los las localidades rurales a la malla de la siguiente manera:

a) Se eligieron las variables de interés (las mismas de los AGEB urbanos incluidas en las mallas para 2000, 2005 y 2010). Se eliminaron las localidades con población mayor a 2,500 habitantes, puesto que estas ya son localidades urbanas y su información se encuentra incluida en los AGEB urbanos.  

b) Se intersectó el shapefile de las localidades rurales con la malla (se hizo lo mismo para los tres periodos) y se le asignó la información de las localidades a las cuadrículas que intersectaran los puntos de las localidades. Si dos localidades caían dentro de una misma cuadrícula, entonces se sumaron o promediaron los valores según el tipo de variable (total o promedio). Además, si en una cuadrícula en donde ya existía información de las AGEB urbanas intersecta una localidad rural, entonces de igual manera se suman o promedian los valores.  

Utilizando la información de las localidades rurales, se incluyó a la malla la distancia mínima, en metros, del centro de cada cuadrícula a la localidad rural más cercana.  Esta variable fue incluida debido a que se considera que las localidades rurales cercanas a la zona urbana tienden a migrar en busca de trabajo y servicios. 

### Económicos
Cercanía a unidades económicas (DENUE) y al centro urbano

la distancia de cada cuadrícula a las unidades económicas grandes y medianas que se encuentran en el Directorio Estadístico Nacional de Unidades Económicas (DENUE). Para realizar esto primero se consideran unidades económicas grandes a las que registren tener a más de 250 empleados y medianas a las que registren entre 51 y 250 empleados. A partir de estas unidades se calculó la distancia mínima en metros que hay desde el centro de cada cuadrícula a estas unidades.

La distancia que hay de cada cuadrícula al centro urbano. Para ello, primero se encontró el centro urbano y se expandió hasta un radio de 1 km, donde se considera que se acumulan las principales actividades económicas del centro urbano. A partir de ese radio se calculo la mínima distancia en metros que hay desde el centro de cada cuadrícula al centro urbano como se muestra en la figura siguiente. 


### Vías de Comunicación
carreteras, vías férreas, aeropuertos
Después se agregó la distancia que hay de cada cuadrícula a las carreteras o vías principales utilizando el mapa de OpenStreetMap para México. La distancia se calculó como la distancia mínima que hay desde el centroide de cada cuadrícula a la red carretera o vías principales como se muestra en la figura de abajo. Se consideraron los siguientes tipos de vías: 

- Autopistas (motorway, motorway_link)
- Red primaria (primary, primary_link)
- Red secundaria (secondary, secondary_link)
- Red terciaria (tertiary, tertiary_link)
- Red troncal (trunk, trunk_link)


### Geográficos
pendiente, se probó con porcentaje de pendiente y en grados.

La pendiente se construyó a partir de la altura de los Modelos Digitales de Elevación (INEGI 2000 a escala de 1:250 metros) la cual viene en formato raster.  

Se extrajo la información del raster para incluirla a la malla por medio  una función que se aplica a los valores del raster (pixeles) que caen dentro de una misma cuadrícula. Se crearon tres varibles distintas una para cada función: 
- slope_mean: utilizando el promedio   
- slope_med: utilizando la mediana   
- slope_max: utilizando el máximo   

Después de las variables económicas se agregó una variable que indica el tipo de uso de suelo al que pertenece cada cuadrícula, de acuerdo con las Capas de Uso de Suelo III, IV y V de INEGI(a escala 1:250 000) para cada una de las mallas del año que le corresponda. La información de las capas de uso de suelo muestra la distribución geográfica de los diferentes tipos de vegetación natural (primaria y secundaria) y de la vegetación inducida. La variable se agregó de la siguiente manera:

i) Con la información de INEGi de las capas de uso de suelo:   
- Serie III de 2002-2005 con año de referencia 2002 que utiliza imágenes LANDSATTM (30m)   
- Serie IV de 2006-2010 con año de referencia 2007 que utiliza imágenes SPOT 5 (10m).   
- Serie V de 2011- 2013 con año de referencia 2011 que utiliza imágenes LANDSAT (30m)   
ii) Las categorías de las capas de uso de suelo de las tres series, se reclasificaron y agruparon en 10 categorías, mostradas en la tabla siguiente:   

--Tabla Categoría Uso de Suelo

iii) Después se transformaron las coordenadas de las capas de uso de suelo agrupadas, para que estuvieran en el mismo sistema de coordenadas que las mallas (UTM zona 13).   

iv) Se intersectaron las capas de uso de suelo agrupadas con las mallas, cada una con el periodo que le corresponde. A partir de ahí se agregó una variable a la malla que indica el número de la categoría de uso de suelo que ocupa mayor porcentaje de área dentro de la cuadrícula.   


### Label
Con el fin de poder medir las causas de expansión urbana, se define en este trabajo la  variable de interés (a predecir)  como un cambio en el uso de suelo de no-urbano a urbano, en un periodo de tiempo determinado.



## Modelos




 